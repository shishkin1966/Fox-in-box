

**Clean Architecture version 5**
 
Пример реализации Clean Architecture при построении приложения

При построении приложения использован шаблон [Service Locator](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff648968(v=pandp.10)). В соответствии с архитектурой Clean Architecture приложение разделено на слои. Каждый слою определен свой провайдер. Архитектура приложения реализует следующую цепочку событий:

 источник (view <-> презентер) -> запрос (Action) -> провайдер -> исполнитель провайдера -> сообщение с результатом -> мессаджер -> получатель (презентер или иной объект)

Например провайдер Observable объектов поддерживает следующие объекты:
- BroadcastReceiver
- Content Provider
- именованные Observable объекты

Для  провайдера Observable объектов цепочка событий представляет собой:

 событие (Action) -> провайдер Observable объектов -> сообщение с результатом -> мессаджер сообщений -> получатель сообщений (презентер или иной объект)

Объект мессаджер  реализует в себе свойства Flowable. 

Все объекты делятся на генераторы сервиса и пользователей(потребителей) сервисов. Выделены следующие единицы:
- Provider - объект, который предоставляет сервис любым пользователям(объектам) без их учета
- объекты-подписчики (ProviderSubscriber), которые регистрируются в объединениях для получения/предоставления сервиса
- малые объединения подписчиков(SmallUnion) - объект группы подписчиков(ProviderSubscriber) для получения/предоставления сервиса
- объединения подписчиков(Union) - объект группы подписчиков(ProviderSubscriber) для получения/предоставления расширенной функциональности

Регистрацию подписчиков и их объединений, а также специалистов и их взаимное связывание, отмену регистрации осуществляет сервис локатор (Service Locator).

Все объекты учитываемые сервис локатором реализуют интерфейсы IValidated и ISubscriber. 

Provider - объект, предоставляющий какую-либо функциональность любым объектам.  
Объединение(SmallUnion или Union) подписчиков (классов, реализующие интерфейс IProviderSubscriber) учитывает объекты подписчики только одного типа. Интерфейс IProviderSubscriber является наследником интерфейса ISubscriber.
    
По времени жизни провайдеры делятся на:
- постоянные (или синглтоны). Время жизни - время жизни приложения. Не могут быть выгружены
- нормальные. Могут быть загружены и выгружены
- короткоживущие. Самовыгружающиеся специалисты по какому-либо признаку(например по бездействию или отсутствию подписчиков)

Пример малого объединения SmallUnion - малое объединение презентеров. Объединения поддерживают функцию выбора текущего подписчика. Например объединение Activity позволяет получить текущую на экране Activity.

Как было указано, управлением провайдеров и объединений занимается администратор (Service Locator), реализующий интерфейс IServiceLocator.

Регистрация провайдеров(объединений) проводиться по его имени.

Привязка и отвязка подписчиков (классов с интерфейсом IProviderSubscriber) к провайдерам осуществляется ServiceLocator или самим провайдером. Если провайдер не загружен производится автоматическая создание необходимых провайдеров (объединений). Отписка подписчиков сервис локатором проводится сразу от всех подписанных им провайдеров. 

В данном проекте реализованы следующие провайдеры:
- LogSingleton - предоставляет услуги по протоколированию работы приложения
- ApplicationSingleton - провайдер приложения
- CrashProvider - регистратор падений приложения
- AnalyticsProvider - провайдер аналитики
- WakeLockProvider - провайдер Wake Locks
- PresenterUnion - union презентеров
- DesktopProvider - провайдер рабочих столов
- ObservableUnion - union Observable объектов
- NetExecutor - executor для сетевых запросов
- CommonExecutor - executor для общих запросов
- SessionProvider - провайдер сессии
- NetProvider - провайдер сетевых запросов
- SecureProvider - провайдер шифрации/дешифрации
- StorageProvider - хранилище Serializable объектов
- NotificationProvider - вывод Notification
- ActivityUnion - union для Activities
- MessengerUnion - union для доставки сообщений объектам
- JobProvider - провайдер запуска задач
